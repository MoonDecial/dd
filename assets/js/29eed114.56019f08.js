"use strict";(self.webpackChunk_motion_canvas_docs=self.webpackChunk_motion_canvas_docs||[]).push([[3626],{876:(e,n,t)=>{t.d(n,{Zo:()=>m,kt:()=>f});var a=t(2784);function r(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function i(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function o(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?i(Object(t),!0).forEach((function(n){r(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):i(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function c(e,n){if(null==e)return{};var t,a,r=function(e,n){if(null==e)return{};var t,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)t=i[a],n.indexOf(t)>=0||(r[t]=e[t]);return r}(e,n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)t=i[a],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(r[t]=e[t])}return r}var l=a.createContext({}),s=function(e){var n=a.useContext(l),t=n;return e&&(t="function"==typeof e?e(n):o(o({},n),e)),t},m=function(e){var n=s(e.components);return a.createElement(l.Provider,{value:n},e.children)},d="mdxType",u={inlineCode:"code",wrapper:function(e){var n=e.children;return a.createElement(a.Fragment,{},n)}},p=a.forwardRef((function(e,n){var t=e.components,r=e.mdxType,i=e.originalType,l=e.parentName,m=c(e,["components","mdxType","originalType","parentName"]),d=s(t),p=r,f=d["".concat(l,".").concat(p)]||d[p]||u[p]||i;return t?a.createElement(f,o(o({ref:n},m),{},{components:t})):a.createElement(f,o({ref:n},m))}));function f(e,n){var t=arguments,r=n&&n.mdxType;if("string"==typeof e||r){var i=t.length,o=new Array(i);o[0]=p;var c={};for(var l in n)hasOwnProperty.call(n,l)&&(c[l]=n[l]);c.originalType=e,c[d]="string"==typeof e?e:r,o[1]=c;for(var s=2;s<i;s++)o[s]=t[s];return a.createElement.apply(null,o)}return a.createElement.apply(null,t)}p.displayName="MDXCreateElement"},9055:(e,n,t)=>{t.d(n,{Z:()=>f});var a=t(2784),r=t(6277),i=t(211),o=t(1077);const c="admonition_qNG0",l="admonitionHeading_l909",s="admonitionIcon_UNbs",m="admonitionContent_oUmQ";const d={note:{infimaClassName:"secondary",iconComponent:function(){return a.createElement("svg",{viewBox:"0 0 14 16"},a.createElement("path",{fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))},label:a.createElement(o.Z,{id:"theme.admonition.note",description:"The default label used for the Note admonition (:::note)"},"note")},tip:{infimaClassName:"success",iconComponent:function(){return a.createElement("svg",{viewBox:"0 0 12 16"},a.createElement("path",{fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))},label:a.createElement(o.Z,{id:"theme.admonition.tip",description:"The default label used for the Tip admonition (:::tip)"},"tip")},danger:{infimaClassName:"danger",iconComponent:function(){return a.createElement("svg",{viewBox:"0 0 12 16"},a.createElement("path",{fillRule:"evenodd",d:"M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"}))},label:a.createElement(o.Z,{id:"theme.admonition.danger",description:"The default label used for the Danger admonition (:::danger)"},"danger")},info:{infimaClassName:"info",iconComponent:function(){return a.createElement("svg",{viewBox:"0 0 14 16"},a.createElement("path",{fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))},label:a.createElement(o.Z,{id:"theme.admonition.info",description:"The default label used for the Info admonition (:::info)"},"info")},caution:{infimaClassName:"warning",iconComponent:function(){return a.createElement("svg",{viewBox:"0 0 16 16"},a.createElement("path",{fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))},label:a.createElement(o.Z,{id:"theme.admonition.caution",description:"The default label used for the Caution admonition (:::caution)"},"caution")}},u={secondary:"note",important:"info",success:"tip",warning:"danger"};function p(e){const{mdxAdmonitionTitle:n,rest:t}=function(e){const n=a.Children.toArray(e),t=n.find((e=>{var n;return a.isValidElement(e)&&"mdxAdmonitionTitle"===(null==(n=e.props)?void 0:n.mdxType)})),r=a.createElement(a.Fragment,null,n.filter((e=>e!==t)));return{mdxAdmonitionTitle:t,rest:r}}(e.children);return{...e,title:e.title??n,children:t}}function f(e){const{children:n,type:t,title:o,icon:f}=p(e),h=function(e){const n=u[e]??e,t=d[n];return t||(console.warn(`No admonition config found for admonition type "${n}". Using Info as fallback.`),d.info)}(t),g=o??h.label,{iconComponent:k}=h,v=f??a.createElement(k,null);return a.createElement("div",{className:(0,r.Z)(i.k.common.admonition,i.k.common.admonitionType(e.type),"alert",`alert--${h.infimaClassName}`,c)},a.createElement("div",{className:l},a.createElement("span",{className:s},v),g),a.createElement("div",{className:m},n))}},6047:(e,n,t)=>{t.d(n,{Z:()=>d});var a=t(7896),r=t(2784),i=t(9055);const o="icon_Fw4I";function c(e){return r.createElement("svg",(0,a.Z)({viewBox:"0 0 24 24",fill:"currentColor"},e),r.createElement("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-6h2v6zm0-8h-2V7h2v2z"}))}function l(e){return r.createElement("svg",(0,a.Z)({viewBox:"0 0 24 24",fill:"currentColor"},e),r.createElement("path",{d:"M1 21h22L12 2 1 21zm12-3h-2v-2h2v2zm0-4h-2v-4h2v4z"}))}function s(e){return r.createElement("svg",(0,a.Z)({viewBox:"0 0 24 24",fill:"currentColor"},e),r.createElement("path",{d:"M15.73 3H8.27L3 8.27v7.46L8.27 21h7.46L21 15.73V8.27L15.73 3zM12 17.3c-.72 0-1.3-.58-1.3-1.3 0-.72.58-1.3 1.3-1.3.72 0 1.3.58 1.3 1.3 0 .72-.58 1.3-1.3 1.3zm1-4.3h-2V7h2v6z"}))}function m(e){return r.createElement("svg",(0,a.Z)({viewBox:"0 0 24 24",fill:"currentColor"},e),r.createElement("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 17h-2v-2h2v2zm2.07-7.75l-.9.92C13.45 12.9 13 13.5 13 15h-2v-.5c0-1.1.45-2.1 1.17-2.83l1.24-1.26c.37-.36.59-.86.59-1.41 0-1.1-.9-2-2-2s-2 .9-2 2H8c0-2.21 1.79-4 4-4s4 1.79 4 4c0 .88-.36 1.68-.93 2.25z"}))}function d(e){const n=(0,r.useMemo)((()=>{switch(e.type){case"tip":return m;case"caution":return l;case"danger":return s;default:return c}}),[e.type]);return r.createElement(r.Fragment,null,r.createElement(i.Z,(0,a.Z)({icon:r.createElement(n,{className:o})},e)))}},2397:(e,n,t)=>{t.d(n,{Z:()=>o});var a=t(2784),r=t(6047),i=t(9817);function o(){return a.createElement(r.Z,{type:"caution"},"If you are using Firefox make sure to check if"," ",a.createElement("code",null,"dom.textMetrics.fontBoundingBox")," is enabled else you might not see the"," ",a.createElement(i.Z,{to:"/api/2d/components/Text"},a.createElement("code",null,"Text")),". You can enable this by navigating to ",a.createElement("code",null,"about:config"),".")}},7217:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>s,contentTitle:()=>c,default:()=>u,frontMatter:()=>o,metadata:()=>l,toc:()=>m});var a=t(7896),r=(t(2784),t(876)),i=t(2397);const o={sidebar_position:7,slug:"/references"},c="References",l={unversionedId:"getting-started/references",id:"getting-started/references",title:"References",description:"Usually, when creating a node, we want to store a reference to it, so we can",source:"@site/docs/getting-started/references.mdx",sourceDirName:"getting-started",slug:"/references",permalink:"/docs/references",draft:!1,editUrl:"https://github.com/motion-canvas/motion-canvas/blob/main/packages/docs/docs/getting-started/references.mdx",tags:[],version:"current",lastUpdatedBy:"Jacob",sidebarPosition:7,frontMatter:{sidebar_position:7,slug:"/references"},sidebar:"docs",previous:{title:"Tweening",permalink:"/docs/tweening"},next:{title:"Time Events",permalink:"/docs/time-events"}},s={},m=[{value:"<code>ref</code> property",id:"ref-property",level:2},{value:"<code>createRef()</code> function",id:"createref-function",level:2},{value:"<code>makeRef()</code> function",id:"makeref-function",level:2},{value:"Array of references",id:"array-of-references",level:3},{value:"Custom functions",id:"custom-functions",level:3},{value:"<code>makeRefs()</code> function",id:"makerefs-function",level:2}],d={toc:m};function u(e){let{components:n,...t}=e;return(0,r.kt)("wrapper",(0,a.Z)({},d,t,{components:n,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"references"},"References"),(0,r.kt)("p",null,"Usually, when creating a node, we want to store a reference to it, so we can\nanimate it later. One way to do that is by assigning it to a variable first, and\nthen adding it to the scene:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-tsx"},"const circle = <Circle />;\nview.add(circle);\n\n// we can now animate our circle:\nyield * circle.scale(2, 0.3);\n")),(0,r.kt)("admonition",{type:"info"},(0,r.kt)("p",{parentName:"admonition"},"If you're used to libraries such as React, the above example may seem strange.\nIn Motion Canvas, the JSX components immediately create and return an instance\nof the given class. It's completely valid to store it as a reference and use it\nthroughout the animation.")),(0,r.kt)("p",null,"But this approach doesn't scale well. The more nodes we add, the harder it gets\nto see the overall structure of our scene. Consider the following example:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-tsx"},"const rectA = <Rect />;\nconst rectB = <Rect />;\nconst circle = <Circle>{rectA}</Circle>;\nview.add(\n  <Layout>\n    {circle}\n    {rectB}\n  </Layout>,\n);\n")),(0,r.kt)("p",null,"And now compare it to a version that doesn't store any references:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-tsx"},"view.add(\n  <Layout>\n    <Circle>\n      <Rect />\n    </Circle>\n    <Rect />\n  </Layout>,\n);\n")),(0,r.kt)("p",null,"If you find the latter example more readable, this guide is for you."),(0,r.kt)("h2",{id:"ref-property"},(0,r.kt)("inlineCode",{parentName:"h2"},"ref")," property"),(0,r.kt)("p",null,"Each node in Motion Canvas has a property called ",(0,r.kt)("inlineCode",{parentName:"p"},"ref")," that allows you to create\na reference to said node. It accepts a callback that will be invoked right after\nthe node has been created, with the first argument being the newly created\ninstance."),(0,r.kt)("p",null,"With this in mind, we can rewrite the initial example as:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-tsx"},"let circle: Circle;\nview.add(\n  <Circle\n    ref={instance => {\n      circle = instance;\n    }}\n  />,\n);\n\nyield * circle.scale(2, 0.3);\n")),(0,r.kt)("p",null,"Using the ",(0,r.kt)("inlineCode",{parentName:"p"},"ref")," property in this way is not really practical, and we wouldn't\nrecommend it. But it's crucial to understand how it works because all the\nupcoming methods use this property as a base."),(0,r.kt)("h2",{id:"createref-function"},(0,r.kt)("inlineCode",{parentName:"h2"},"createRef()")," function"),(0,r.kt)("p",null,"The preferred way of using the ",(0,r.kt)("inlineCode",{parentName:"p"},"ref")," property is in conjunction with the\n",(0,r.kt)("a",{parentName:"p",href:"/api/core/utils#createRef"},(0,r.kt)("inlineCode",{parentName:"a"},"createRef()"))," function. Continuing with our\nexample, we can rewrite it as:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-tsx"},"import {createRef} from '@motion-canvas/core/lib/utils';\n\n// ...\n\nconst circle = createRef<Circle>();\nview.add(<Circle ref={circle} />);\n\nyield * circle().scale(2, 0.3);\n")),(0,r.kt)("p",null,"Notice that ",(0,r.kt)("inlineCode",{parentName:"p"},"circle")," is no longer just a variable that points to our circle.\nInstead, it's a ",(0,r.kt)("a",{parentName:"p",href:"/docs/signals"},"signal-like")," function that can be used to access\nit. Invoking it without any arguments (",(0,r.kt)("inlineCode",{parentName:"p"},"circle()"),") returns our instance."),(0,r.kt)("p",null,"Going back to the example with the more complex scene, we can now rewrite it as:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-tsx"},"const rectA = createRef<Rect>();\nconst rectB = createRef<Rect>();\nconst circle = createRef<Circle>();\nview.add(\n  <Layout>\n    <Circle ref={circle}>\n      <Rect ref={rectA} />\n    </Circle>\n    <Rect ref={rectB} />\n  </Layout>,\n);\n")),(0,r.kt)("h2",{id:"makeref-function"},(0,r.kt)("inlineCode",{parentName:"h2"},"makeRef()")," function"),(0,r.kt)("p",null,"Another common use case of the ",(0,r.kt)("inlineCode",{parentName:"p"},"ref")," property is to assign the newly created\ninstance to a property of some object. In the following example, we assign our\ncircle to ",(0,r.kt)("inlineCode",{parentName:"p"},"circle.instance")," (We'll talk about why this may be useful in a bit):"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-tsx"},"const circle = {instance: null as Circle};\nview.add(\n  <Circle\n    // highlight-start\n    ref={instance => {\n      circle.instance = instance;\n    }}\n    // highlight-end\n  />,\n);\n")),(0,r.kt)("p",null,"We can use the ",(0,r.kt)("a",{parentName:"p",href:"/api/core/utils#makeRef"},(0,r.kt)("inlineCode",{parentName:"a"},"makeRef()"))," function to simplify this\nprocess:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-tsx"},"import {makeRef} from '@motion-canvas/core/lib/utils';\n\n// ...\n\nconst circle = {instance: null as Circle};\nview.add(\n  // highlight-next-line\n  <Circle ref={makeRef(circle, 'instance')} />,\n);\n")),(0,r.kt)("h3",{id:"array-of-references"},"Array of references"),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"makeRef()")," can be particularly useful when we create an array of nodes and want\nto grab references to all of them:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-tsx"},"const circles: Circle[] = [];\nview.add(\n  <Layout>\n    {range(10).map(index => (\n      // highlight-next-line\n      <Circle ref={makeRef(circles, index)} />\n    ))}\n  </Layout>,\n);\n")),(0,r.kt)("p",null,"In JavaScript, arrays are objects whose properties are their indices. So\n",(0,r.kt)("inlineCode",{parentName:"p"},"makeRef(circles, index)")," will set the nth element of our array to the created\ncircle. As a result, we end up with an array of size ",(0,r.kt)("inlineCode",{parentName:"p"},"10")," filled with circles\nthat we can use to animate all of them."),(0,r.kt)("h3",{id:"custom-functions"},"Custom functions"),(0,r.kt)(i.Z,{mdxType:"FirefoxTextWarning"}),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"makeRef()")," can also be used to return more than one reference from a custom\nfunction component:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-tsx"},"function Label({\n  refs,\n  children,\n}: {\n  refs: {rect: Rect; text: Text};\n  children: string;\n}) {\n  return (\n    // highlight-next-line\n    <Rect ref={makeRef(refs, 'rect')}>\n      // highlight-next-line\n      <Text ref={makeRef(refs, 'text')}>{children}</Text>\n    </Rect>\n  );\n}\n\nconst label = {rect: null as Rect, text: null as Text};\nview.add(<Label refs={label}>HELLO</Label>);\n\n// we can now animate both the Rect and the Text of our label:\nyield * label.rect.opacity(2, 0.3);\nyield * label.text.fontSize(24, 0.3);\n")),(0,r.kt)("p",null,"In this example, we define a function component called ",(0,r.kt)("inlineCode",{parentName:"p"},"Label")," consisting of a\nrectangle with some text inside. When using the component, we use the ",(0,r.kt)("inlineCode",{parentName:"p"},"refs"),"\nproperty to pass the ",(0,r.kt)("inlineCode",{parentName:"p"},"label")," object created by us. ",(0,r.kt)("inlineCode",{parentName:"p"},"makeRef()")," is then used to\nfill this object with all the necessary references."),(0,r.kt)("h2",{id:"makerefs-function"},(0,r.kt)("inlineCode",{parentName:"h2"},"makeRefs()")," function"),(0,r.kt)(i.Z,{mdxType:"FirefoxTextWarning"}),(0,r.kt)("p",null,"Looking at the previous example, you may notice that we had to define the ",(0,r.kt)("inlineCode",{parentName:"p"},"refs"),"\ntype twice. First in the ",(0,r.kt)("inlineCode",{parentName:"p"},"Label")," declaration and then again when creating the\n",(0,r.kt)("inlineCode",{parentName:"p"},"label")," object:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-tsx"},"function Label({\n  refs,\n  children,\n}: {\n  // highlight-next-line\n  refs: {rect: Rect; text: Text};\n  children: string;\n}) {\n  return (\n    <Rect ref={makeRef(refs, 'rect')}>\n      <Text ref={makeRef(refs, 'text')}>{children}</Text>\n    </Rect>\n  );\n}\n\n// highlight-next-line\nconst label = {rect: null as Rect, text: null as Text};\nview.add(<Label refs={label}>HELLO</Label>);\n")),(0,r.kt)("p",null,"We can use ",(0,r.kt)("a",{parentName:"p",href:"/api/core/utils#makeRefs"},(0,r.kt)("inlineCode",{parentName:"a"},"makeRefs()"))," to eliminate this\nredundancy. It can extract the type from the ",(0,r.kt)("inlineCode",{parentName:"p"},"Label")," declaration and create an\nempty object matching it:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-tsx"},"import {makeRef, makeRefs} from '@motion-canvas/core/lib/utils';\n\n// ...\n\nfunction Label({\n  refs,\n  children,\n}: {\n  // highlight-next-line\n  refs: {rect: Rect; text: Text};\n  children: string;\n}) {\n  return (\n    <Rect ref={makeRef(refs, 'rect')}>\n      <Text ref={makeRef(refs, 'text')}>{children}</Text>\n    </Rect>\n  );\n}\n\n// highlight-next-line\nconst label = makeRefs<typeof Label>();\nview.add(<Label refs={label}>HELLO</Label>);\n")))}u.isMDXComponent=!0}}]);